<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Gishiki Documentation</title>
	<script type="text/javascript" src="scripts/shCore.js"></script>
	<script type="text/javascript" src="scripts/shBrushJScript.js"></script>
        <script type="text/javascript" src="scripts/shBrushPhp.js"></script>
	<script type="text/javascript" src="scripts/shBrushXml.js"></script>
	<link type="text/css" rel="stylesheet" href="styles/shCoreEclipse.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
	
        <!-- Bootstrap core CSS -->
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <!-- Bootstrap theme -->
        <link href="bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">


        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="bootstrap/js/html5shiv.min.js"></script>
          <script src="bootstrap/js/respond.min.js"></script>
        <![endif]-->
	
	<script src="bootstrap/js/jquery.min.js"></script>
	<script src="bootstrap/js/bootstrap.min.js"></script>
	<script src="bootstrap/js/ie10-viewport-bug-workaround.js"></script>
	
	<link type="text/css" rel="stylesheet" href="documentation.css"/>
	
</head>

<body role="document">

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">Gishiki Documentation</a>
	</div>
	
	<ul class="nav navbar-nav">
		<li><a href="https://github.com/NeroReflex/Gishiki">GitHub</a></li>
		<li><a href="license.html">License</a></li>
		<li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Credits <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="bootstrap.html">Bootstrap</a></li>
			<li><a href="syntaxhighlighter.html">SyntaxHighlighter</a></li> <!--http://alexgorbatchev.com/SyntaxHighlighter/-->
          </ul>
        </li>
	</ul>
		
  </div><!-- /.container-fluid -->
</nav>
<div class="textBlock">
<h2>Connections</h2>
As it is written in the Model chapter, each model implements a database handler. In order to use the database, a connection must be opened.<br />
Opening a connection can be done in different ways:
<ul>
<li>Let the framework to auto-load a stored connection</li>
<li>Using a stored connection</li>
<li>Using a connection string</li>
</ul>
The best way for opening a connection for the first time is using a connection string.<br />
A connection string is a string that contains every information needed by the framework to correctly perform the desired connection.<br />
<br />
Let's see an example:
<pre class="brush: php;">
class User_Controller extends Gishiki_Controller {
    function ConnectionExample($username)
    {
        //connect this model to the database
        $this->CreateConnection("sqlite3://my_precious_DB:my secret DB p@ssword");

        //store the connection for future uses
        $this->SaveConnection("DB_connection");
    }
}
</pre>
This will create a connection to the sqlite3 database called "my_precious_DB", using the password "my secret DB p@ssword", and, if the database doesn't exist, it will be created.<br />
After creating the connection that connection will be stored with the name of "DB_connection", allowing that same connection to be used in the future.<br /><br />
Looks like a piece of cake, doesn't it? However, you probably need to know more about connection strings, this is why I have created an enteire chapter about that argument.
<br /><br /><br />

From now on, we have stored a connection called "DB_connection" that we can use to connect the database without rewriting each time the connection string.
<br />This feature is particulary useful because when you have to change your RDBMS, you only need to sobstitute one file, instead of your models!<br />
You can use that stored connection this way:
<pre class="brush: php;">
class User_Controller extends Gishiki_Controller {
    function ConnectionExample($username)
    {
        //store the connection for future uses
        $this->UseConnection("DB_connection");
    }
}
</pre>
Once you have stored a database connection, reconnecting is even simpler and shorter than connecting for the first time.<br />
<br /><br />
However, if you don't want to "<i>manually</i>" connect your models to your database(s) you can use the <b>auto-connection</b> feature.<br />
When you save a connection, if you call it "<b><i>global</i></b>", every model will automatically use that connection, and for connecting models to that database, you don't have to write 
a single line of code anymore! When Gishiki installs itself on your server, it creates a connection called "<i>Default<i>". 
You can rename that connection to global to have a connection and a database ready in two or three seconds.<br />
However, think about a web application that needs 2 or more databases, the database auto-connection feature may connect some models to the wrong database. 
To avoid this problem you can call a database connection as your model. This way the global connection will be 
ignored and the connection called as the model will be used.<br /><br />
<div class="alert alert-info">
    <b>Is my model connected? </b>
    You can check wether your model is connected to a database or not by calling the <b>CheckConnection</b> function.<br />
    The CheckConnection function returns true only if the model is correctly connected to a database.
</div>
<br />
<div class="alert alert-info">
    <b>Good to know: </b>Every stored connection is located inside the folder "connections" by default. You can change that folder changing your config.php file.<br />
    Every connection is stored as a file called as the connection, with .xml extension. You should never show those files to anyone, but if you accidentaly do, don't worry: the password
    for your database is encrypted and the key is inside the config.php file.<br />Keep in mind that changing the default encryption key in config.php will invalidate every 
    previously stored connection.
</div>

</div>
</body>

</html>

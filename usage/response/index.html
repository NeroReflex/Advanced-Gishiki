<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Response - Gishiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Response";
    var mkdocs_page_input_path = "usage/response.md";
    var mkdocs_page_url = "/usage/response/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Gishiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../installation/">Environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/basic_php/">Basic PHP</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/php_7_nginx/">PHP 7.0 & nginx</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/basic_nginx/">Basic nginx</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/basic_apache/">Basic apache</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/basic_lighttpd/">Basic lighttpd</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/basic_iis/">Basic IIS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/composer/">Composer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/paas/">PaaS</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../apidoc/">API</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Usage</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../routing/">Router</a>
                </li>
                <li class="">
                    
    <a class="" href="../request/">Request</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Response</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#response">Response</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#response-header">Response Header</a></li>
        
            <li><a class="toctree-l4" href="#response-header-details">Response Header Details</a></li>
        
            <li><a class="toctree-l4" href="#response-body">Response Body</a></li>
        
            <li><a class="toctree-l4" href="#more-about-response">More about Response</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../logging/">Logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../CRUD/">CRUD</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">CLI</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../cli/">CLI Toolkit</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">About</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../license/">License</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Gishiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Usage &raquo;</li>
        
      
    
    <li>Response</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="response">Response</h1>
<p>The Response object passed to a controller implements <strong>ResponseInterface</strong> defined on the
<a href="http://www.php-fig.org/psr/psr-7/">PSR-7 sheet</a> and follows that specification sheet.</p>
<p>Each <a href="../request/">Request</a> sent to the web server triggers the generation of a <a href="./">Response</a>.</p>
<p>That response is automatically sent back to the client at the end of the
application lifecycle.</p>
<p>The main target of an application is <strong>editing</strong> that response before the departure
of that response.</p>
<p>An HTTP response is made of two parts:</p>
<ul>
<li>Response <strong>header</strong> </li>
<li>Response <strong>body</strong></li>
</ul>
<p>Those parts and steps to generate them are described later on this document.</p>
<h2 id="response-header">Response Header</h2>
<p>Every HTTP response <strong>MUST</strong> contains an header.</p>
<p>An HTTP header have a bare minimum structure that comprises the HTTP revision,
the status code and the message associated to the status code.</p>
<p>Since each status code have its own predefined status phrase (like 404 not found,
500 internal server error, 200 OK and so on) when the status code is changed the
status phrase is automatically changed by the framework.</p>
<p>That can be done calling the <strong>withStatus()</strong> function:</p>
<pre><code class="php">//the response code - phrase will be 404 - Not Found
$response-&gt;withStatus(404);
</code></pre>

<p>You can manually change the status phrase, but you are discouraged from doing such
thing with standard status code!</p>
<p>What you can do is using it to send a strong signal to a bad client:</p>
<pre><code class="php">//numberOfRequests is the number of requests that a client has sent within 60 minutes
if ($numberOfRequests &gt; 50) {
    //perform the complex operation (may stress the system)
    action();
} else {
    //stop flooding my servers!
    $response = $response-&gt;withStatus(666, 'FUCK YOU!');
}
</code></pre>

<p>Sorry for the bad language, that was only intended to help me to give you a (real :D)
example of usage.</p>
<h2 id="response-header-details">Response Header Details</h2>
<p>Each response can contains a lot of details about itself like the length of the
content or the type of the content.</p>
<p>In order to edit the value of a property you have to use the <strong>withHeader()</strong> function:</p>
<pre><code class="php">$request = $request-&gt;withHeader('Cache-Control', 'no-store, no-cache, must-revalidate');
</code></pre>

<p>If you are unsure on how to use this feature you should read more about http response <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">header</a>.</p>
<h2 id="response-body">Response Body</h2>
<p>The body of the response is the main part of the response: the <strong>content</strong> of the
response.</p>
<p>For example if the response is an html content the response body is what the
user calls <em>the webpage</em>.</p>
<p>To directly modify the response body you can use the <strong>write()</strong> function on the
stream reference returned by the <strong>getBody</strong> function:</p>
<pre><code class="php">$content = &lt;&lt;&lt;EOT
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;My webpage&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;My webpage&lt;/h1&gt;
        &lt;p&gt;Hello, this is my personal webpage!&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
EOT;

//write the response
$response = $response-&gt;withHeader('Content-Type', 'text/html');
$response-&gt;getBody()-&gt;write($content);
</code></pre>

<p>Keep in mind that you can provide your <strong>OWN</strong> Stream by calling the <em>withBody()</em> function.</p>
<p>To adhere to PSR-7 standard the body stream <strong>MUST</strong> implement StreamInterface.</p>
<h2 id="more-about-response">More about Response</h2>
<p>This is only a brief introduction to general PSR-7 programming.</p>
<p>Actually Gishiki uses Zend <a href="https://github.com/zendframework/zend-diactoros">Diactoros</a>.</p>
<p>Read more about Zend Diactoros <a href="https://docs.zendframework.com/zend-diactoros/overview/">here</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../logging/" class="btn btn-neutral float-right" title="Logger">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../request/" class="btn btn-neutral" title="Request"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../request/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../logging/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
